# Swagger Utils

`swagger.ts` provides a helper function specifically for manipulating a Swagger/OpenAPI specification object. In many applications, API routes are grouped under a common prefix (e.g., `/api/v1`). While the route handlers themselves are mounted under this prefix in Express, the OpenAPI specification generated by tools like `swagger-jsdoc` might not automatically include this global prefix in the path definitions.

This utility solves that problem by programmatically adding a given prefix to every path in the specification.

## `addSwaggerPathPrefix` Function

This is the sole function exported by the utility.

### `addSwaggerPathPrefix(swaggerSpec: OpenAPIV3.Document, prefix: string): OpenAPIV3.Document`

Takes a complete OpenAPI V3 document object and a prefix string. It iterates through all the `paths` in the specification and prepends the `prefix` to each one, returning a new, modified specification object.

- **`swaggerSpec`**: The input OpenAPI document.
- **`prefix`**: The string to prepend to all paths (e.g., `/api/v1`).

**Usage:**

This function is typically used when setting up the `swagger-ui-express` middleware, right after the specification has been generated.

```typescript
import express from 'express';
import swaggerUi from 'swagger-ui-express';
import swaggerJsdoc from 'swagger-jsdoc';
import { addSwaggerPathPrefix } from './utils/swagger';

const app = express();

const options = {
  definition: {
    openapi: '3.0.0',
    info: { title: 'My API', version: '1.0.0' },
    paths: {
      '/users': { get: { summary: 'Get all users' } },
      '/health': { get: { summary: 'Health check' } },
    },
  },
  apis: ['./src/routes/*.ts'],
};

// 1. Generate the base specification
const baseSpec = swaggerJsdoc(options);

// 2. Define the global API prefix
const apiPrefix = '/api/v1';

// 3. Use the utility to add the prefix to all paths
const prefixedSpec = addSwaggerPathPrefix(baseSpec, apiPrefix);

// 4. Serve the modified spec via Swagger UI
app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(prefixedSpec));

// The paths in the UI will now correctly appear as:
// /api/v1/users
// /api/v1/health
```
